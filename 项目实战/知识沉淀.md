## 样式统筹

### 全局样式

#### 通用样式  

> 如果大部分页面需要用到更改样式后的ui组件，可以给这部分组件添加特殊类名，并在全局样式进行样式配置。且此时不需要用到 `/deep/`。

`global.css`

```css
//----------- 全局的输入框样式 --------- 
// 需要添加类名 global-input 才能生效
.global-input {}
```



#### 整体布局

> 大部分页面都要用到相同布局，可以将修改后的样式放在统一文件中，通过路由控制不同区域，减少重复。
>
> 该栗为顶部栏固高固位，底部栏固高，位于内容栏之下。
>
> 其实通过 `fixed` 布局实现更容易，考虑到兼容性不允许？

`main.vue`


```vue
<el-container>

    <!-- 上面内容 -->
    <el-header>
        <page-top />
    </el-header>
    
    <el-container class="container">
        <!-- 中间内容 -->
        <el-main>
            <!-- 内容出口 -->
            <router-view></router-view>
        </el-main>
        <!-- 下面内容 -->
        <el-footer>
            <page-bottom />
        </el-footer>
    </el-container>

</el-container>

<style lang="less" scoped>
.el-header, .el-main, .el-footer {
	padding: 0px;
}
.el-header {
	height: 40px !important;
}
.container {
	height: calc(100vh - 40px);
	overflow: auto;
}
.el-main {
	background-color: rgb(240, 242, 245);
	// 改变组件默认值
	overflow: visible;
}	
.el-footer {
	height: 115px !important;
}
</style>
```



#### 标签类名控样式

> 通过父类、标签、特殊类名限制样式规则。

`global.css`

```vue
<text class='cuIcon-cameraadd'></text>
```

```css
/* 通过类名筛选 */
.grid.grid-square>view>text[class*="cuIcon-"] { ... }
```



## 功能实现

### 表单相关

#### 未完成提交按钮不可用

> 要求在所有表单项都填写完毕前，提交按钮为特殊样式且点击不生效。
>
> 按理来说在计算属性中获取表单是否通过验证的返回值更合理。`elment-ui` 的按钮本身有提供 `disabled` 属性，动态绑定后，根据需求更改样式就行。

#### 登录验证失败样式

> 要求在点击登录按钮后，若账号/密码错误，在密码输入框下侧出现文字提示，且所有输入框标红。
>

```vue
<a-form-model :class="{errorLogin: errorLogin}">..</a-form-model> 

本地数据初始化
errorLogin: false;

登录请求的失败回调
error(data: any, message: string, parameters: any) {
  me.errorLogin = true;
}

账号/密码表单项获焦时取消该特殊样式
cleanErrorLogin() {
  if(this.errorLogin) {
    this.errorLogin = false;
  }
}


/* 登录失败的的表单样式 */
/deep/ .errorLogin {
	.ant-input {
		border: 1px solid #f5222d;
	}
	// 给第二个表单项，即密码的后面添加文字
	& > :nth-child(2) {
		position: relative;
		&::after {
			position: absolute;
			content: '用户名或密码不正确';
			left: 20px;
			color: #DC0816;
		}
	}
}
```



### 动态化

#### 接口报错未找到  

> 有些业务分为私人/公共两块，接口不要调错了。 

#### 将对象写入本地缓存

> 对象不能直接存入缓存，需先转换为字符串。另外，该转换方法只能对对象类型使用。 

```javascript
// 定义了键的名称
import appConfig from './config.js';

// state
window.localStorage.setItem(appConfig.stateKeyName, JSON.stringify(state));
// token
window.localStorage.setItem(appConfig.tokenKeyName, token);
```

#### 退出登录逻辑

> 先发起退出登录的请求，请求成功后，清缓存，跳转到登录页。



### 初始化数据

#### 页面内外均可控制页面内容  

> 情景：底部区域为所有页面共用的子组件，它有几个导航。从其它页面点击时，跳转到 `Help` 页面并渲染对应内容；从 `Help` 页面点击时，渲染不同的内容。

`footer.vue`

```less
<span @click="handleClick('主题')">主题</span>
<span @click="handleClick('乐园')">乐园</span>
<span @click="handleClick('协议')">协议</span>

handleClick(type) {
  this.$router.push({
    path: '/help',
    query: {
      type
    },
  });
}
```

`Help.vue`

```javascript
methods: {
  initPage() {
    this.title = this.$route.query.type;
    /* 在这里请求页面需要的数据 */ 
  }
},
watch: {
  '$route.query': {
    handler: 'initPage',
    // 立即触发回调，即从其它页面跳转过来时触发
    immediate: true
  }
}
```

### 事件相关

#### 组件存在多个删除的回调  

> 情景：存在多项不同的信息，但都提供了删除按钮，点击时都会以[弹框](https://element.eleme.cn/#/zh-CN/component/message-box)确认。
>
> 思路：可以用同一个回调，传入不同字符串进行区分，并在success中执行不同的删除方法，来简练代码。





