## main.ts

```javascript
import Vue from 'vue';
import App from './App.vue';

import router from './router';
import store from './store';
import axios from 'axios';
import qs from 'qs';

/* 完整引入 Ant 组件及样式、并额外将消息组件和图标组件导出 */
import Antd, {Icon, message}  from 'ant-design-vue';
import 'ant-design-vue/dist/antd.css';

/* 导入组件，用于全局注册 */
import pageHead from './components/top.vue'; 
import pageBottom from './components/bottom.vue';

/* 导入全局样式和图标样式 */
import './assets/css/global.scss';
import './assets/fonts/iconfont.css';

/* 导入一些辅助方法，将添加到原型上，每个实例都可以访问 */
import loading from './js/loading';
import baseConfig from './js/config.js';
import app from './js/app.js';
import roleHelper from './js/roleHelper.js';
import basicRequest from './js/basicRequest.js';
import pageHelper from './js/pageHelper.js';

/* 关闭生产模式下给出的提示 */
Vue.config.productionTip = false;

Vue.use(Antd); 

Vue.prototype.$store = store;
Vue.prototype.$http = axios;
Vue.prototype.$qs = qs;
Vue.prototype.$message = message;

Vue.prototype.$loading = loading;
Vue.prototype.$baseConfig = baseConfig;
Vue.prototype.$app = app;
Vue.prototype.$roleHelper = roleHelper;
Vue.prototype.$basicRequest = basicRequest;
Vue.prototype.$pageHelper = pageHelper;

/* 自定义 font 图标 */
const IconFont = Icon.createFromIconfontCN({
	/* 导入本地文件要用require */
	scriptUrl: require("./assets/fonts/iconfont.js")
    
    /* 实际上也可以使用网络地址 */
    // scriptUrl: '//at.alicdn.com/t/font_2745733_00dww5mfg9ki7.js'
});

Vue.component('page-top',pageHead);
Vue.component('page-bottom',pageBottom);
Vue.component('c-font-icon',IconFont);

new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')
```

项目 | 说明
:- | :-
qs | 可以在url的查询部分与js对象之间[相互转换](https://blog.csdn.net/suwu150/article/details/78333452)
[Icon.createFromIconfontCN](https://www.antdv.com/components/icon-cn/#自定义-font-图标) | 全局注册后，组件渲染前会自动引入项目中的图标集
iconfont.js | [图表库](https://www.iconfont.cn/) - 具体项目 - Symbol - 弹出网页展示的代码 - 拷贝

## App.vue  

```vue
<template>
	<a-config-provider :locale="zhCN">
		<div id="app">
			<a-spin :spinning="loading" :tip="loadingTip">
				<router-view />
			</a-spin>
		</div>
	</a-config-provider>
</template>
<script>
	import {mapState,mapMutations} from 'vuex'
	import zhCN from 'ant-design-vue/lib/locale-provider/zh_CN';
	import moment from 'moment';
	import 'moment/locale/zh-cn';

	moment.locale('zh-cn');

	export default {
		data() {
			return {
				zhCN,
			};
		},
		computed: {
		    /* 将状态管理中的状态，以同名方式作为该组件的计算属性 */
			...mapState(["loading","loadingTip"]),
			/* 等价于
			loading(){
				return this.$store.state.loading;
			},
			loadingTip(){
				return this.$store.state.loadingTip;
			}*/
		}
	};
</script>
```

组件 | 属性 | 说明
:- | :- | :-
a-config-provider | locale | 语言包配置，可到 ant-design-vue/lib/locale-provider/ 目录下寻找
a-spin | spinning | 是否为加载中状态
a-spin | tip | 作为**包裹元素**时的自定义描述文案

### moment
> 日期处理类库，用于解析、操作、显示日期。  

#### 设定moment区域为中国  

```javascript
import moment from 'moment';
import 'moment/locale/zh-cn';

moment.locale('zh-cn');
```

## store
> index.ts

```javascript
export default new Vuex.Store({
  state: {
	  loading: false,
	  loadingTip:""
  },
  mutations: {
	showLoading(state:any, opt?:any){
		state.loadingTip = (opt===undefined)||!opt.tips?"加载中，请稍等……":opt.tips;
		state.loading = true;   
	},
	hideLoading (state) {
		state.loading = false;
	}
  }
})
```

> 若没有传入配置，使用默认提示。即使传入了配置，也要先检查该配置对象是否合规。  

## validate.js.js

```javascript
export const regular = {
	// 验证自然数
	naturalNumber: /^(([0-9]*[1-9][0-9]*)|(0+))$/,
	naturalNumberMsg: '请输入自然数',
	// 微信号
	wechat: /^[a-zA-Z]([-_a-zA-Z0-9]{5,19})+$/,
	wechatMsg: '请输入正确的微信号码',
	// 英文
	english: /^.[A-Za-z]+$/,
	englishMsg: '请输入英文字符',
	// 手机
	phone: /^1[3|4|5|7|8][0-9]{9}$/,
	phoneMsg: '请输入正确的手机号',
	// 座机
	telephone: /^\d{3}-\d{7,8}|\d{4}-\d{7,8}$/,
	telephoneMsg: '请输入正确的座机号',
	// 银行卡号码
	bankCard: /^[1-9]\d{9,19}$/,
	bankCardMsg: '请输入正确的银行卡号码',
	// 证件号码
	IDNumber: /^[a-z0-9A-Z]{0,50}$/,
	IDNumberMsg: '请输入正确的证件号码',
	// 身份证号码,包括15位和18位的
	IDCard: /(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{7}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}$)/,
	IDCardMsg: '请输入正确的身份证号码',
	// QQ号码
	qq: /^[1-9]\d{4,11}$/,
	qqMsg: '请输入正确的QQ号码',
	// 网址, 仅支持http和https开头的
	url: /^(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-.,@?^=%&:/~+#]*[\w\-@?^=%&/~+#])?$/,
	urlMsg: '请输入以http和https开头的网址',
	// 0到20位的英文字符和数字
	enNum0to20: /^[a-z0-9A-Z]{0,20}$/,
	enNum0to20Msg: '请输入20位以内的英文字符和数字',
	// 2到100位的中英文字符和空格
	cnEnSpace2to100: /^[a-zA-Z\u4E00-\u9FA5\s*]{2,100}$/,
	cnEnSpace2to100Msg: '请输入2到100位的中英文字符和空格',
	// 数字和换行符
	numLinefeed: /^[0-9\n*]+$/,
	numLinefeedMsg: '请输入数字和换行符',
	// 255位以内的字符
	char0to255: /^.{0,255}$/,
	char0to255Msg: '请输入255位以内的字符',
	// 特殊字符
	specialChar: /^[^`~!@#$^&*()=|{}':;',/\\[\].<>?]*$/,
	specialCharMsg: '请删除特殊字符',
	// 保留两位小数
	twoDecimal: /^(([0-9][0-9]*)|(([0]\.\d{1,2}|[0-9][0-9]*\.\d{1,2})))$/,
	twoDecimalMsg: '小数点保留最多两位'
}
/**
 * @description 排序值验证，排序值不可以大于255
 */
export const validateOrder = function(rule, value, callback) {
	if (parseInt(value) > 255) {
		return callback(new Error('排序值不可以大于255'))
	} else {
		callback()
	}
}
```

## roleHelper.js

```javascript
/* 默认登录为学生端 */
const defaultAlias = "student";
const ROLE_CONFIG={
    // 拥有不同权限的各种身份
	system:{
		roleId:1331533939218,
		roleName:"系统管理员",
		use:11,
		alias:"manager",
		entranceName:"DMAI管理平台",
		account:"平台管理员",
		isShow:true
	},
	...,
    // 根据角色Id获取身份配置
	getByRoleId(roleId){
		for(let p in this){
			if(typeof this[p]=="function"){
				continue;
			}
			if(this[p].roleId == roleId){
				return this[p];
			}
		}	
		return undefined;
	},
	getByAlias(alias){...},
	
	/**
	 * 判断是否对用户开发该入口
	 * 注：如果入口为public则表示公用页面
	 * @param {Object} user 用户对象
	 * @param {Object} entrance 入口
	 */
        
    // 有些入口，多种身份都具有权限
    // 剩余的只有对应相应身份，才具备权限
	allowEntrance(user,entrance){
		let uses = user.role.uses;
		uses = uses.split(",");
		if(entrance=="public"){
			return true;
		}
		if(entrance=="race"){
			for(let i=0;i<uses.length;i++){          	  
				if(uses[i]==ROLE_CONFIG.teacher.use||uses[i]==ROLE_CONFIG.student.use||uses[i]==ROLE_CONFIG.race.use){
					return true;
				}
			}	
		}
		for(let p in this){
			let _item = this[p];
			if(typeof this[p]=="function"){
				continue;
			}
			for(let i=0;i<uses.length;i++){
				if((_item.use+"") === uses[i] && _item.alias == entrance){
					return true;
				}
			}
		}
		return false;
	}
};
/* 是否展示某些内容 */
const isShowTeachingMaterial=function(user,entrance){
	if(!user||!user.id){
		return false;
	}
	let roleId = user.role.id;
    // 下面这行没有用上
	let config = ROLE_CONFIG.getByRoleId(roleId);
	if(roleId==ROLE_CONFIG.student.roleId){
		return true;
	}else if(roleId==ROLE_CONFIG.teacher.roleId){
		return true;
	}else if(roleId==ROLE_CONFIG.auditor.roleId){
		return true;
	}else if(roleId==ROLE_CONFIG.creator.roleId){
		return true;
	}
	return false;
};
/* 直接调用对象中的方法并导出 */
const getByRoleId = function(roleId){
	return ROLE_CONFIG.getByRoleId(roleId);
};

export default {
	ROLE_CONFIG,
	defaultAlias,
	isShowTeachingMaterial,
	
	getByRoleId
};
```

